# Quick Start Guide - WasteFreeBD RBAC System

## ğŸš€ Quick Setup (5 Minutes)

### 1ï¸âƒ£ Prepare Dependencies
```bash
cd "c:\Users\Youtech BD\OneDrive\Desktop\wastefreeBD\wastefreebd"
flutter pub get
```

### 2ï¸âƒ£ Create Supabase Table (3 Steps)

1. Open [Supabase Dashboard](https://app.supabase.com)
2. Go to SQL Editor
3. Copy-paste and execute this SQL:

```sql
CREATE TABLE IF NOT EXISTS public.signin (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  email character varying not null unique,
  password character varying null,
  "Name" text not null,
  role character varying not null default 'user' check (role in ('admin', 'management', 'accountant', 'user')),
  constraint signin_pkey primary key (id)
) TABLESPACE pg_default;

CREATE INDEX IF NOT EXISTS idx_signin_email ON public.signin(email);

INSERT INTO public.signin (email, password, "Name", role) VALUES
('admin@wastefreebd.com', 'admin123', 'Admin User', 'admin'),
('manager@wastefreebd.com', 'manager123', 'Manager User', 'management'),
('accountant@wastefreebd.com', 'accountant123', 'Accountant User', 'accountant'),
('user@wastefreebd.com', 'user123', 'Regular User', 'user')
ON CONFLICT (email) DO NOTHING;

ALTER TABLE public.signin ENABLE ROW LEVEL SECURITY;
```

### 3ï¸âƒ£ Run the App
```bash
flutter run
```

Or in VS Code: Press `F5`

---

## ğŸ” Test Credentials

| Role | Email | Password | Features |
|------|-------|----------|----------|
| **Admin** | admin@wastefreebd.com | admin123 | Dashboard, Finance, Inventory, Waste, Workers |
| **Manager** | manager@wastefreebd.com | manager123 | Inventory, Waste, Workers |
| **Accountant** | accountant@wastefreebd.com | accountant123 | Finance Overview |
| **User** | user@wastefreebd.com | user123 | Basic Dashboard |

---

## âœ… What You'll See

### 1. Login Page
- Clean, green-themed login interface
- Demo users button for reference
- Error messages for invalid login

### 2. Role-Based Dashboards
- **Admin**: 5 screens with full system access
- **Manager**: 3 screens for operational management
- **Accountant**: 1 screen for financial data
- **User**: 1 general dashboard

### 3. Features per Dashboard

#### Admin Dashboard
- Dashboard Overview
- Financial Overview
- Inventory Management
- Waste Stock
- Worker Management

#### Manager Dashboard
- Inventory Management
- Waste Stock
- Worker Management

#### Accountant Dashboard
- Financial Overview

#### User Dashboard
- Basic Dashboard

---

## ğŸ“ Key Files Modified/Created

| File | Purpose |
|------|---------|
| `lib/pages/login_screen.dart` | New login page |
| `lib/main.dart` | RBAC routing logic |
| `lib/providers/auth_provider.dart` | Updated with Supabase integration |
| `lib/services/auth_service.dart` | Updated with proper field names |
| `SUPABASE_SETUP.sql` | SQL script for table creation |
| `RBAC_SETUP_INSTRUCTIONS.md` | Detailed setup guide |

---

## ğŸ› Common Issues & Fixes

### Issue: "No pubspec.yaml file found"
```
âœ… Fix: Run from correct directory:
cd "c:\Users\Youtech BD\OneDrive\Desktop\wastefreeBD\wastefreebd"
```

### Issue: Login fails with "Invalid email or password"
```
âœ… Fix: 
1. Check Supabase table has the test users
2. Verify email format exactly matches
3. Check password is correct
```

### Issue: Wrong dashboard appears after login
```
âœ… Fix:
1. Check role value in Supabase database
2. Verify roles are: admin, management, accountant, user
3. Make sure "Name" column is used (capital N)
```

### Issue: App crashes on startup
```
âœ… Fix:
1. Verify Supabase URL and anon key in main.dart
2. Ensure your Supabase project is active
3. Check internet connection
4. Try: flutter clean && flutter pub get
```

---

## ğŸ”„ Workflow

```
1. App Starts
   â†“
2. Check if User Authenticated?
   â”œâ”€ YES â†’ Route to Role Dashboard
   â””â”€ NO â†’ Show Login Screen
   â†“
3. User Enters Credentials
   â†“
4. Validate Against Supabase
   â”œâ”€ VALID â†’ Store User + Route to Dashboard
   â””â”€ INVALID â†’ Show Error Message
   â†“
5. User Clicks Logout
   â†“
6. Clear User Data â†’ Back to Login Screen
```

---

## ğŸ¨ UI/UX Features

âœ… **Login Screen**
- Green theme consistent with waste management
- Eco icon branding
- Password visibility toggle
- Demo users reference dialog
- Loading indicator during login
- Error message display

âœ… **Dashboard Headers**
- Show current role (Admin, Manager, etc.)
- Display user's full name
- Easy logout button

âœ… **Navigation**
- Role-specific bottom navigation
- Only shows screens user has access to
- Clean, intuitive interface

---

## ğŸ“Š Role Permissions Summary

### Admin (Full Access)
```
âœ… Dashboard
âœ… Financial Overview
âœ… Inventory Management
âœ… Waste Stock
âœ… Worker Management
```

### Manager (Operational)
```
âŒ Dashboard (View Only)
âŒ Financial Overview
âœ… Inventory Management
âœ… Waste Stock
âœ… Worker Management
```

### Accountant (Financial)
```
âŒ Dashboard
âœ… Financial Overview
âŒ Inventory Management
âŒ Waste Stock
âŒ Worker Management
```

### User (Basic)
```
âœ… Dashboard (Basic)
âŒ Other Screens
```

---

## ğŸš€ Next Steps

1. Test each role login
2. Verify dashboard displays correct screens
3. Try logout function
4. Add custom users to Supabase table
5. Customize dashboards per role
6. Implement permissions for specific actions

---

## ğŸ“ Need Help?

- Check `RBAC_SETUP_INSTRUCTIONS.md` for detailed guide
- Review code comments in `lib/main.dart`
- Check `lib/pages/login_screen.dart` for UI implementation
- Review `lib/providers/auth_provider.dart` for state management

---

**Happy Testing! ğŸ‰**
